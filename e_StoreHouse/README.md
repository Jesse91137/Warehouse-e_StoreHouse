

# 成品倉人員手動執行系統

post_title: 成品倉人員手動執行系統
author1: 內部開發團隊
post_slug: e-storehouse-manual
microsoft_alias: N/A

---

## 簡介

本系統為「成品倉人員手動執行」的桌面工具，用於協助日常倉儲作業與 Excel 資料匯入。主要目的包括：加速每日資料處理、減少手動錯誤、並提供簡易的故障排除途徑。

本文件著重於操作流程與匯入規範，讓使用者能明白系統運作及遇到問題時該如何處理。

## 主要功能

- Excel 資料每日匯入（批次處理、欄位檢核）
- 成品庫存及作業登入（手動建立/修改記錄）
- 作業日誌與錯誤排除（輸出錯誤報表）

## 架構概覽

- 執行檔：`e_StoreHouse.exe`（WinForms 桌面程式）
- 設定：`App.config`
- 相依套件：NPOI（Excel 讀寫）、Portable.BouncyCastle（加密支援）、SharpZipLib（壓縮）

## 前置需求

1. Windows 10/11（建議）
2. .NET Framework 4.7.2 或相容版本（請依專案 csproj 指定版本安裝）
3. Visual Studio（僅在開發或自行建置時需要）

## 安裝與建置

1. 以 Visual Studio 開啟 `e_StoreHouse.sln`。
2. 還原 NuGet 相依套件（Restore）。
3. 建置（Build）專案。
4. 執行檔位於 `e_StoreHouse\bin\Debug\e_StoreHouse.exe` 或 `bin\Release`（視建置模式而定）。

## 快速上手（使用者步驟 - 最小流程）

1. 將要匯入的 Excel 檔案放入指定輸入資料夾（下方「匯入規範」有說明路徑與檔名格式）。
2. 執行 `e_StoreHouse.exe`。
3. 在主畫面選擇『Excel 匯入』（或類似按鈕），系統會列出可匯入檔案。
4. 選擇檔案後，按『開始匯入』。系統會執行欄位檢核並回報結果。
5. 匯入成功的記錄會寫入系統資料（或輸出匯入成功報表）；匯入失敗則會在錯誤清單或日誌中顯示錯誤原因。

## 詳細操作流程（逐步）

### 1) 啟動程式

- 執行 `e_StoreHouse.exe`。
- 首次執行時請確認 `App.config` 中必要的設定（例如資料庫連線字串、匯入資料夾路徑）已正確設定。

### 2) 主介面說明

- 導覽列 / 左側功能：切換功能頁（匯入、庫存管理、報表）。
- 主畫面區域：顯示目前可匯入的檔案、最近日誌、常見錯誤摘要。
- 操作按鈕：
  - 匯入/開始：觸發檔案讀取與資料寫入流程。
  - 預覽：讀取 Excel 前幾筆供人檢視欄位對應。
  - 匯出錯誤：將錯誤列表輸出成 CSV/Excel 供客服或維運分析。

### 3) Excel 匯入規範（重要）

請務必遵守以下規範，以避免匯入失敗：

- 檔案格式：XLSX 或 XLS（建議使用 XLSX）。
- 檔名規範：例如 `YYYYMMDD_來源_批次.xlsx`（系統會使用檔名解析來源與批次，若未遵守，須人工指定來源）。


- 欄位對應（範例）：
  - 欄位 A: 條碼 / 產品編號（必填）
  - 欄位 B: 批號（非必填，但若存在須正確格式）
  - 欄位 C: 數量（必填，整數）
  - 欄位 D: 入庫日期（格式 YYYY-MM-DD，若空值系統使用匯入當日）

- 空白或格式錯誤處理：系統會在匯入前執行驗證，若欄位不符會列出錯誤並可選擇：跳過該列、以預設值補正或中止整個批次。

### 4) 匯入流程（內部步驟，供維運理解）

1. 程式開啟檔案並使用 NPOI 讀取工作表與儲存格。
2. 欄位轉換與資料型態驗證（例如數量為整數、日期格式合法）。
3. 逐筆寫入資料庫或本地檔案系統（依系統設定）。
4. 若有例外，該筆會記錄到錯誤清單，流程可依設定繼續或中止。
5. 完成後產生匯入報告（成功筆數、失敗筆數、錯誤摘要）供使用者下載。

## 日誌與錯誤處理

- 日誌位置：程式目錄下的 `Logs` 資料夾（若不存在會自動建立）
- 日誌內容包含：匯入開始/結束時間、處理筆數、錯誤訊息（含列號與欄位）
- 取得日誌：在主畫面可按『檢視日誌』或直接到 `bin\Debug\Logs`（或 `Release`）查看最新檔案。

### 常見錯誤與處理方式

- 錯誤：資料庫連線失敗 → 檢查 `App.config` 的連線字串、資料庫是否啟動
- 錯誤：欄位格式不符 → 使用『預覽』功能檢查欄位並修正 Excel 檔案
- 錯誤：無法讀取檔案（已開啟）→ 關閉 Excel 或其他程式對該檔案的鎖定

## 常見問與答（FAQ）

Q: 我該把 Excel 放在哪個資料夾？
A: 預設為 `e_StoreHouse\Input`（請確認 `App.config` 中的 `ImportFolder` 設定），若找不到請詢問管理員或檢視設定。

Q: 匯入失敗如何排除？
A: 先檢查 Logs，確認是哪一行哪一欄出錯；修正後可重新匯入該檔案或該筆資料。

Q: 我可以一次匯入多個檔案嗎？
A: 支援批次匯入，多個檔案會依序處理。若任一檔案遇到嚴重錯誤，流程行為依 `App.config` 的錯誤處理設定而定（中止或跳過）。

## 維運與開發人員備註

- 程式碼入口：`Program.cs`。
- 若要修改匯入欄位對應，請在專案中尋找 `Import` 或 `Excel` 相關類別進行變更。
- 建議：在修改前備份 `App.config`，並在測試環境先驗證匯入流程。

## 聯絡／回報問題

如遇到無法排除的錯誤，請將錯誤日誌（Logs）與範例 Excel 一併回報給內部開發團隊，或於專案管理系統建立 issue 並附上錯誤截圖與日誌。

## 授權

本專案僅供內部使用，未經授權請勿轉載或公開。

---

**免責聲明**：本文件由內部開發團隊維護，部分範例或建議可能需依組織流程調整。如發現不適當或錯誤，請至專案 issue 回報。
